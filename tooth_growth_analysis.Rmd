---
title: "ToothGrowth data analysis"
output: pdf_document
author: "Alexander Lemm"
---
```{r echo=FALSE, warning=FALSE, message=FALSE}

library(ggplot2)
library(dplyr)
library(wesanderson)
library(grid)

```


## Overiew

In this short report we are going to analyze the `TootGrowth` data of the R data sets package which describes the effect of vitamin C on tooth growth in guinea pigs

The `ToothGrowth` data set consists of 60 observations of 3 variables:

* `len`: Tooth length (numeric variable)
* `supp`: Supplement type (factor variable with levels VC and OJ)
* `dose`: Dose in milligrams (numeric variable)

Even though `dose` is a numeric variable we will treat it as a factor in the subsequent analysis because only three dose levels of Vitamin C (0.5, 1, and  2 mg) were used.

In total, we deal with 60 unique guinea pigs. Each pig was assigned to a group which received a specific dose level of vitamin C. In addition, in each of those groups two different delivery methods (orange juice or ascorbic acid) were applied leaving 10 pigs per subgroup:

```{r echo=FALSE}

with(ToothGrowth, table(dose, supp))

```


## Exploratory data analysis


The average guinea pig tooth length is `r mean(ToothGrowth$len)` with a standard deviation of `r sd(ToothGrowth$len)`.

However, we are more interested in finding differences in tooth length across different groups of supplement types, dose levels and their respective combinations.


```{r echo=FALSE, fig.width=7, fig.height=3, fig.align='center'}

g_len_by_supp <- ggplot(ToothGrowth, aes(supp, len)) + 
  geom_boxplot() +
  xlab('Supplement type') +
  ylab('Tooth length') +
  ggtitle('Tooth length by supplement type')

g_len_by_dose <- ggplot(ToothGrowth, aes(as.factor(dose), len)) + 
  geom_boxplot() +
  xlab('Dose (milligrams)') +
  ylab('Tooth length') +
  ggtitle('Tooth length by dose level')


grid.newpage()
# Push viewport to graphic device
pushViewport(viewport(layout = grid.layout(1, 2, widths = c(0.5, 0.5))))
print(g_len_by_supp, vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
print(g_len_by_dose, vp = viewport(layout.pos.row = 1, layout.pos.col = 2))

```

The left box plot above reveals that guinea pigs which received their dose of vitamin C using orange juice have on average a greater tooth length than those pigs which got their dose using ascorbic acid. The orange juice group distribution is skewed to the left whereas the ascorbic acid group seems to be fairly symmetric. 

Grouping by dose level reveals even greater differences in tooth length and their respective means. The differences between the dose level groups are so big that not even the interquartile range boundaries overlap:

```{r echo = FALSE}

ToothGrowth %>% group_by(dose) %>% 
  summarize(
    q25 = quantile(len, 0.25),
    q75 = quantile(len, 0.75)
  ) %>%
  as.data.frame

```

Both trends can be further observed when examining tooth length differences across both groups at the same time.

```{r echo=FALSE, fig.width=5, fig.height=3.5}

ggplot(ToothGrowth, aes(as.factor(dose), len)) +
  geom_boxplot(aes(fill = as.factor(dose))) + 
  facet_grid(. ~ supp) +
  xlab('Dose (milligrams)') +
  ylab('Tooth length') +
  ggtitle('Tooth length by dose level and supplement type') +
  scale_fill_manual(values = wes_palette("FantasticFox")) +
  theme(legend.position = "none")

```

## Statistical inference

### Conditions

Since we dealing with subsets of n <= 30 our standard error estimate will generally not be accurate. Therefore, we will use the t distribution for our hypothesis tests and confidence intervals.

Based on the current information is hard to check if the 2 necessary prerequisites for this setup are met:

1. Independence of the observations
2. Observations come from a nearly normal distribution.

However, we assume that the guinea pigs were randomly assigned to one of the groups (guarantees independence) and that they were sampled from a nearly normal population.

### Testing

First, we will check if the observed difference of the mean between the 2 supplement groups is statistically different from 0. 

Our conservative choice will be a t-test with unequal variances of the two samples.

```{r echo=FALSE}

t_diff_supp <- t.test(len ~ supp, ToothGrowth, var.equal = FALSE)

```

With a p-value of `r t_diff_supp$p.value` which is larger than the significance value, 0.05, we fail to reject the null hypothesis. The data does not provide strong evidence that the average difference in tooth length across the two supplement types is different from 0. 

The hypothesis test result corresponds to the respective confidence interval `r t_diff_supp$conf.int[1:2]` which includes 0.


## Conclusions

